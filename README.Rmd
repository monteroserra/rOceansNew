---
tittle: rOceansNew - Examples
author: I. Montero-Serra
date: 22/Jun/2018
output: html_document
---

## rOceans 
An R Package for exploring spatial trends in marine biodiversity and conservation. Here
have examples of functions to access and explore spatial patterns of marine biodiversity. 
The functions are separated in set #1 for single or few species analyses and set #2 for
analyzing large data sets downloaded from OBIS or GBIF. 

*Currently, working on further set of functions to access and explore spatial data on climate change and other stressors as well as MPAs coverage. 

(1) Download rOceansNew from GitHub and load the package
```{r}

devtools::install_github("monteroserra/rOceansNew")
library(rOceansNew)

````

# First set of functions for accessing and exploring data for single/few marine species

Function #1.1, called *oceanDivDat* allows accessing occurrence data from GBIF and OBIS for a given vector of species names. It also allows merging data from these two sources and removing duplicates as well as land-based occurrences. 


```{r}
# Define target species names: example with two corals
coral_species = c("Corallium rubrum", "Acropora palmata", "Paramuricea clavata")

# Get, merge and filter occurrences using oceanDivDat()

corals = oceanDivDat(species_names = coral_species,
                     data_source = "OBIS_&_GBIF", 
                     remove_duplicates = T, 
                     remove_land_dots = T)

head(corals)

```

Function #1.2, called *presenceRaster* creates a presence / absence raster from occurrence data. We can use *cell_size* to specify the sieze of cells within the grid (by default 
cell_size = 5ยบ). 

```{r}

corals_presence = presencesRaster(occurrences=corals, 
                                         cell_size=5)


```


Function #1.3, called *oceanRichness* creates a species richness raster from occurrence data of multiple species. We can use *cell_size* to specify the sieze of cells within the grid (by default cell_size = 5ยบ). 

```{r}

corals_richness = oceanRichness(occurrences=corals, 
                                cell_size=5, 
                                richness_map = T)

```


Function #1.4, called *oceanMaps* is a versatile data mapping function for a rapid visualization of marine biodiversity patterns previously computed.  


```{r}

oceanMaps(corals_presence)

oceanMaps(corals_richness)

```


# Functions #2: data check, filter & analyses of large datasets of marine distribution data from OBIS and GBIF.



First, we need to access and download data from GBIF (www.gbif.org) and OBIS (www.iobis.org). 
Here I show an example with data of species within the genus *Acropora* downloaded from the website. The data can be accessed from my GitHub repository "monteroserra/rOceanData"

```{r}

#read the data setting stringsAsFactors = F to avoid issues when reading wrong coordiantes. 

Acropora_OBIS = read.csv2("Acropora_OBIS.csv", stringsAsFactors = F)
Acropora_GBIF = read.csv2("Acropora_GBIF.csv", stringsAsFactors = F)


```


Checking, filtering and merging the raw data into a common standard database. 

```{r}

Acropora_OBIS_checked = oceanDataCheck(OBIS_occurrences = Acropora_OBIS, source = "OBIS")
Acropora_GBIF_checked = oceanDataCheck(GBIF_occurrences = Acropora_GBIF, source = "GBIF")

Acropora_Total_Checked = oceanDataCheck(GBIF_occurrences = Acropora_GBIF,
                                        OBIS_occurrences = Acropora_OBIS,
                                        source = "GBIF_&_OBIS")



```


```{r}


```

